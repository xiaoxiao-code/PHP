# 项目示例

# 综合项目一：简单文件管理器

项目目的：综合运用`scandir()`、`is_dir()`、`mkdir()`、`unlink()`来`file_exists()`创建一个可以浏览当前目录、创建新文件夹和删除文件的简单文件管理器。
综合知识点运用：
- 目录读取： `scandir()`
- 目录创建： `mkdir()`
- 文件删除： `unlink()`
- 类型检查： `is_dir()`
- 存在性检查： `file_exists()`
- 表单处理： `$_POST`和`isset()`
- URL参数： `$_GET` (用于删除操作)
## 完整代码 ( `explorer.php`)
```php
<?php
// --- 1. 处理表单和URL操作 ---

$message = ""; // 用于向用户显示反馈

// a. 处理创建目录
if (isset($_POST['create_folder'])) {
    $folder_name = trim($_POST['folder_name']);
    if (!empty($folder_name) && !file_exists($folder_name)) {
        if (mkdir($folder_name)) { // 
            $message = "目录 '{$folder_name}' 创建成功！";
        } else {
            $message = "创建目录失败。";
        }
    } elseif (file_exists($folder_name)) {
        $message = "错误：文件或目录 '{$folder_name}' 已存在。";
    } else {
        $message = "错误：目录名不能为空。";
    }
}

// b. 处理删除文件 (使用 GET 参数)
if (isset($_GET['delete_file'])) {
    $file_to_delete = $_GET['delete_file'];
    
    // 安全检查：确保文件存在且不是一个目录
    if (file_exists($file_to_delete) && !is_dir($file_to_delete)) { // [cite: 1792-1793, 1800-1802]
        if (unlink($file_to_delete)) { // 
            $message = "文件 '{$file_to_delete}' 删除成功！";
        } else {
            $message = "删除文件失败。";
        }
    } elseif (is_dir($file_to_delete)) {
        $message = "错误：不能删除目录。";
    } else {
        $message = "错误：文件不存在。";
    }
}

// --- 2. 读取和显示目录内容 ---
$current_dir = "."; // "." 表示当前目录
$files_and_folders = scandir($current_dir); // 

?>
<!DOCTYPE html>
<html>
<head>
    <title>简单文件管理器</title>
    <style>
        body { font-family: sans-serif; }
        .container { max-width: 600px; margin: 20px auto; }
        .file-list { list-style: none; padding: 0; }
        .file-list li { padding: 5px; border-bottom: 1px solid #eee; }
        .file-list li a { color: red; text-decoration: none; float: right; }
        .folder { font-weight: bold; }
        .message { background: #f0f0f0; padding: 10px; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <h2>文件管理器</h2>
        <p>当前目录: <?php echo getcwd(); // ?></p>

        <?php if (!empty($message)): ?>
            <div class="message"><?php echo $message; ?></div>
        <?php endif; ?>

        <form method="post" action="explorer.php">
            <input type="text" name="folder_name" placeholder="新目录名称">
            <input type="submit" name="create_folder" value="创建目录">
        </form>
        <hr>

        <ul class="file-list">
            <?php foreach ($files_and_folders as $item): ?>
                <?php
                // 忽略 . 和 .. 这两个特殊目录
                if ($item == '.' || $item == '..') continue;
                ?>
                <li>
                    <?php if (is_dir($item)): // ?>
                        <span class="folder">[目录] <?php echo $item; ?></span>
                    <?php else: ?>
                        <span class="file">[文件] <?php echo $item; ?></span>
                        <a href="explorer.php?delete_file=<?php echo urlencode($item); ?>" onclick="return confirm('确认删除 <?php echo $item; ?> 吗？');">删除</a>
                    <?php endif; ?>
                </li>
            <?php endforeach; ?>
        </ul>
    </div>

</body>
</html>
```
# 综合项目二：简单访客留言本
项目目的：综合运用`file_put_contents()`进行文件读取读取，以及`file()`（或`file_get_contents()`）进行文件读取，实现一个简单的留言本。
综合知识点运用：
- 文件书写： `file_put_contents()` （配合`FILE_APPEND`标志，实现追加写入，这是`fopen('a')` 和`fwrite()` 的快捷方式）。
- 文件读取： `file()` (将文件按行读入队列)。
- 文件检查： `file_exists()`
- 批量处理：（用于将留言倒序，最新在前） `array_reverse()`。
- 表单处理： `$_POST`和`isset()`。
- 安全处理：（ `htmlspecialchars()`用于安全显示用户输入）。
## 完整代码 ( `guestbook.php`)
```php
<?php
$guestbook_file = "guestbook.txt"; // 存储留言的文件

// --- 1. 处理表单提交 (写入文件) ---
if (isset($_POST['submit'])) {
    // 获取并清理数据
    $name = trim($_POST['name']);
    $message = trim($_POST['message']);

    if (!empty($name) && !empty($message)) {
        // 格式化要写入的字符串
        // date('Y-m-d H:i:s') (来自 8.2.3 节的 date() 函数)
        $entry = date('Y-m-d H:i:s') . " | " . $name . ": " . $message . "\n";

        // 使用 file_put_contents() 追加内容
        // FILE_APPEND 标志确保内容被追加到末尾，而不是覆盖 [cite: 1510-1511, 1560-1561]
        file_put_contents($guestbook_file, $entry, FILE_APPEND);
    }
}

// --- 2. 读取留言 (读取文件) ---
$entries = array(); // 初始化一个空数组
if (file_exists($guestbook_file)) { // 
    // file() 将文件的每一行读取为数组的一个元素 
    $entries = file($guestbook_file);
    // 数组反转，让最新的留言显示在最上面 
    $entries = array_reverse($entries);
}

?>
<!DOCTYPE html>
<html>
<head>
    <title>简单访客留言本</title>
    <style>
        body { font-family: sans-serif; }
        .container { max-width: 500px; margin: 20px auto; }
        .form-group { margin-bottom: 10px; }
        .form-group label { display: block; }
        .form-group input, .form-group textarea { width: 98%; }
        .guestbook-entry { background: #f9f9f9; border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <h2>访客留言本</h2>

        <form method="post" action="guestbook.php">
            <div class="form-group">
                <label for="name">您的昵称:</label>
                <input type="text" id="name" name="name">
            </div>
            <div class="form-group">
                <label for="message">留言内容:</label>
                <textarea id="message" name="message" rows="4"></textarea>
            </div>
            <input type="submit" name="submit" value="提交留言">
        </form>

        <hr>

        <h3>所有留言 (<?php echo count($entries); //?> 条)</h3>
        <div class="entries-list">
            <?php if (count($entries) > 0): ?>
                <?php foreach ($entries as $entry): ?>
                    <div class="guestbook-entry">
                        <?php echo htmlspecialchars($entry); ?>
                    </div>
                <?php endforeach; ?>
            <?php else: ?>
                <p>暂无留言。</p>
            <?php endif; ?>
        </div>
    </div>

</body>
</html>
```