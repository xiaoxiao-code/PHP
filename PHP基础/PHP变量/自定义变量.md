# 自定义变量

# 1 变量的命名规则

在PHP中，所有变量的名称都必须遵循以下规则：
- **必须以 `$` 符号开头** 。
- `$` 之后必须是一个合法的字符串，这意味着：
    - **首字符**必须是字母（a-z, A-Z）或下划线（`_`） 。
    - **后续字符**可以是任意数量的字母、数字（0-9）或下划线 。
- **大小写敏感**：变量名是严格区分大小写的。例如，`$name` 和 `$Name` 是两个完全不同的变量。
# 2 变量的类型与定义
PHP是一种弱类型语言，在定义变量时不需要像C语言那样事先声明类型 。
- **通过初始化定义**：变量通常是通过在第一次使用时为其赋值（初始化）来定义的 。
- **类型自动确定**：变量的类型由所赋给它的值的类型决定 。
示例 ：
```php
<?php
$a = 100;     // $a 为整型 (Integer) 
$b = 3.14;    // $b 为浮点型 (Float) 
$c = "school"; // $c 为字符串型 (String) 
$d = true;    // $d 为布尔型 (Boolean) 
?>
```
# 3 变量赋值的方式
PHP支持两种变量赋值方式：
## 3.1 值赋值 (Value Assignment)
这是最常见的赋值方式，即**将一个变量的值复制给另一个变量**。此时，两个变量相互独立 。
```php
$var = "hello";
$bar = $var; // 将 "hello" 复制给 $bar
$bar = "world"; // 修改 $bar

echo $var; // 输出: hello ( $var 的值不受影响)
```
## 3.2 引用赋值 (Reference Assignment)
引用赋值使用 `&` 符号，它**不会复制值**，而是让两个变量**指向同一个存储单元（内存地址）** 。修改其中任意一个变量，另一个也会随之改变。
示例 ：
```php
<?php
$var = "hello";
$bar = &$var; // $bar 引用 $var (它们指向同一块内存) 

echo $bar; // 输出: hello 

$bar = "world"; // 修改 $bar 
echo $var; // 输出: world ( $var 的值也随之改变) 
?>
```
# 4 变量的作用域 (Scope)
变量的作用域是指一个变量可以被访问的范围（即“在何处有效”）。根据作用域，变量可分为局部变量和全局变量 。
## 4.1 局部变量 (Local Variable)
在主程序中或函数内部定义的变量称为局部变量 。
- **主程序中的局部变量**：其作用域局限于主程序，**不能**在函数内部直接使用 。
- **函数内的局部变量**：其作用域局限于该函数内部，**不能**在主程序中使用 。
示例 ：
```php
<?php
$my_var = "test"; // 主程序的局部变量 

function my_func() {
    $local_var = 123; // my_func() 的局部变量 
    echo '$local_var = ' . $local_var . "<br>"; // 正常输出 
    
    // 尝试访问主程序变量 (失败)
    echo '$my_var = ' . $my_var . "<br>"; // 会显示变量未定义 
}

my_func(); 

echo '$my_var = ' . $my_var . "<br>"; // 正常输出
// 尝试访问函数内变量 (失败)
echo '$local_var = ' . $local_var . "<br>"; // 会显示变量未定义 
?>
```
## 4.2 静态变量 (Static Variable)
静态变量是一种特殊的**函数内部局部变量**，它使用 `static` 关键字声明 。
- **区别**：
    - **自动变量（默认）**：每次调用函数时都会重新创建和初始化，函数调用结束时变量被销毁 。
    - **静态变量**：只在**第一次**调用函数时被初始化 。在函数调用结束后，静态变量**不会被释放**，它会保留其值以供下次调用 。
    示例 ：
```php
<?php
function vars() {
    $a = 0;        // $a 是自动变量 
    static $b = 0; // $b 是静态变量 
    $a++;
    $b++;
    echo "$a, $b" . "<br>";
}

for ($i = 1; $i <= 3; $i++) {
    vars(); 
}
?>
// 运行结果:
// 1, 1 (第一次调用：$a=0, $b=0; 变为 $a=1, $b=1) 
// 1, 2 (第二次调用：$a=0, $b=1; 变为 $a=1, $b=2) 
// 1, 3 (第三次调用：$a=0, $b=2; 变为 $a=1, $b=3)
```
- **程序解释**：`$a` 每次调用时都重置为0 。`$b` 在第一次调用后保留了值1，第二次调用后保留了值2 。
## 4.3 全局变量 (Global Variable)
如果在函数内部需要访问主程序中定义的局部变量（即全局作用域下的变量），必须在函数内部使用 `global` 关键字进行声明 。
- `global` 关键字告诉函数：“接下来要使用的这个变量，是主程序中的那个全局变量，而不是重新定义一个同名的局部变量” 。
示例 ：
```php
<?php
$a = 123; // 主程序变量 (全局作用域) 

function fun() {
    // echo $a; // 如果直接访问，会出错
    
    $a = 456; // 这定义了一个 *新* 的局部变量 $a，与全局 $a 无关 
    echo $a . "<br>"; // 输出: 456 
    
    global $a; // 声明将使用全局变量 $a 
    
    echo $a . "<br>"; // 输出: 123 (这是全局 $a 的值) 
    $a = 789; // 修改全局 $a 的值 
}

fun(); 
echo $a; // 输出: 789 (因为函数fun()修改了全局 $a) 
?>
```